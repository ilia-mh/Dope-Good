{"version":3,"sources":["components/Shop/Products.js"],"names":["Products","setCurrentPage","currentPage","pageEnd","useParams","cat","subcat","dispatch","useDispatch","useState","showLoadMore","setShowLoadMore","firstLoaded","setFirstLoaded","allProducts","useSelector","state","shop","shownProducts","categories","findSubCatCount","subCatIdx","subCategories","findIndex","name","count","existingProducts","reduce","total","subCategory","includes","console","log","useEffect","setTimeout","changeProductsFilterOptions","target","value","className","map","product","_id","activeCat","filter","category","totalProducts","length","isThereMoreProduct","onClick"],"mappings":"6OAQe,SAASA,EAAT,GAA6D,IAAzCC,EAAwC,EAAxCA,eAAgBC,EAAwB,EAAxBA,YAAaC,EAAW,EAAXA,QAE/D,EAAsBC,cAAhBC,EAAN,EAAMA,IAAKC,EAAX,EAAWA,OAEJC,EAAWC,cAEjB,EAAuCC,oBAAS,GAAhD,mBAAOC,EAAP,KAAoBC,EAApB,KACA,EAAqCF,oBAAS,GAA9C,mBAAOG,EAAP,KAAmBC,EAAnB,KAEMC,EAAcC,aAAY,SAACC,GAAD,OAAWA,EAAMC,KAAKH,eAChDI,EAAgBH,aAAY,SAACC,GAAD,OAAWA,EAAMC,KAAKC,iBAClDC,EAAaJ,aAAY,SAACC,GAAD,OAAWA,EAAMC,KAAKE,cA+B/CC,EAAkB,WAEtB,IAAMC,EAAYF,EAAW,GAAGG,cAAcC,WAAW,qBAAGC,OAAoBlB,KACxEmB,EAAUN,EAAW,GAAGG,cAAcD,GAAtCI,MAEFC,EAAmBZ,EAAYa,QAAQ,SAACC,EAAD,YAAUC,YAA8BC,SAASxB,GAAUsB,IAAUA,IAAO,GAIzH,OAFAG,QAAQC,IAAKN,GAENA,EAAmBD,GAiC5B,OA1BAQ,qBAAW,WAETC,YAAW,WACTvB,GAAgB,KACf,KAECC,EAGAL,EADED,EACO6B,YAA4B,CACnCC,OAAQ,MACRC,MAAO,CAAChC,EAAIC,KAGL6B,YAA4B,CACnCC,OAAQ,MACRC,MAAO,CAAChC,MAKZQ,GAAe,KAGjB,CAACR,EAAIC,IAGL,qBAAKgC,UAAU,6CAAf,SACE,sBAAKA,UAAU,MAAf,UAGIpB,GACEA,EAAcqB,KAAI,SAACC,GAAD,OAAa,cAAC,IAAD,CAAaA,QAASA,GAAcA,EAAQC,QAK7E/B,IAAiBP,GAlFE,WAEzB,GAAIE,GAAOC,EAAS,CAElB,GAAIA,EACF,OAAOc,IAGP,IAAMsB,EAAYvB,EAAWwB,QAAQ,qBAAGnB,OAAoBnB,KAAM,GAE5DqB,EAAmBZ,EAAYa,QAAQ,SAACC,EAAD,YAAUgB,SAAwBd,SAASzB,GAAOuB,EAAQ,EAAIA,IAAO,GAElH,QAAIc,GAEKhB,EAAmBgB,EAAUjB,MAQxC,IAAMoB,EAAgB1B,EAAW2B,QAAU3B,EAAWQ,QAAO,SAACC,EAAD,UAAsBA,EAAtB,EAAUH,QAA2B,GAElG,OAAIX,EAAYgC,OAASD,EA0DOE,IAC5B,qBAAKT,UAAU,mBAAf,SAEE,wBAAQA,UAAU,yBAAyBU,QA5C3B,WACxB/C,EAAgBC,EAAc,IA2CtB","file":"static/js/18.ef897332.chunk.js","sourcesContent":["import React, { useEffect, useState, Suspense } from \"react\";\nimport { useSelector, useDispatch } from \"react-redux\";\nimport { useParams } from \"react-router-dom\";\nimport { changeProductsFilterOptions } from \"../../store/Reducer/reducer\";\n\nimport ProductCard from '../Product/ProductCard/ProductCard'\nimport \"./products.scss\";\n\nexport default function Products({ setCurrentPage, currentPage, pageEnd }) {\n\n\tlet { cat, subcat } = useParams();\n\n  const dispatch = useDispatch();\n\n  const [showLoadMore,setShowLoadMore] = useState(false)\n  const [firstLoaded,setFirstLoaded] = useState(false)\n\n  const allProducts = useSelector((state) => state.shop.allProducts);\n  const shownProducts = useSelector((state) => state.shop.shownProducts);\n  const categories = useSelector((state) => state.shop.categories);\n\n  const isThereMoreProduct = () => {\n\n    if( cat || subcat ) {\n\n      if( subcat ) {\n        return findSubCatCount()\n      } else {\n\n        const activeCat = categories.filter( ({ name }) => name === cat )[0]\n\n        const existingProducts = allProducts.reduce( (total, { category }) => category.includes(cat) ? total + 1 : total, 0 )\n\n        if( activeCat ) {\n          \n          return existingProducts < activeCat.count\n        }\n\n        return false\n        \n      }\n\n    } else {\n      const totalProducts = categories.length && categories.reduce((total, { count }) => total + count, 0)\n\n      if( allProducts.length < totalProducts ) return true\n      else return false\n    }\n  }\n\n  const findSubCatCount = () => {\n\n    const subCatIdx = categories[0].subCategories.findIndex( ({ name }) => name === subcat )\n    const { count } = categories[0].subCategories[subCatIdx]\n\n    const existingProducts = allProducts.reduce( (total, { subCategory }) => subCategory.includes(subcat) ? total++ : total, 0 )\n\n    console.log( existingProducts )\n\n    return existingProducts < count\n  }\n\n  const fetchMoreProducts = () => {\n    setCurrentPage( currentPage + 1 )\n  }\n\n  useEffect( () => {\n\n    setTimeout(() => {\n      setShowLoadMore(true)\n    }, 700);\n\n    if( firstLoaded ) {\n\n      if( subcat ){\n        dispatch(changeProductsFilterOptions({\n          target: 'cat',\n          value: [cat,subcat]\n        }))\n      } else {\n        dispatch(changeProductsFilterOptions({\n          target: 'cat',\n          value: [cat]\n        }))\n      }\n\n    } else {\n      setFirstLoaded(true)\n    }\n\n  },[cat,subcat])\n\n  return (\n    <div className=\"col-sm-12 col-md-12 col-lg-9 products-wrap\">\n      <div className=\"row\">\n\n        {\n          shownProducts &&\n            shownProducts.map((product) => <ProductCard product={product} key={product._id} />\n             )\n        }\n\n        {\n          showLoadMore && !pageEnd && isThereMoreProduct() &&\n          <div className=\"load-more-holder\">\n\n            <button className=\"load-more-products-btn\" onClick={fetchMoreProducts} >Load More</button>\n\n          </div>\n        }\n      </div>\n    </div>\n  );\n}\n"],"sourceRoot":""}